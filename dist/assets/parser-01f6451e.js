import{l as De,i as He,r as Ge,a as Ke,o as Le}from"./colorUtils-639f4d25.js";import{a as $}from"./Error-57322e92.js";import{e as Qe}from"./screenUtils-90993e16.js";import{e as St}from"./mat4f32-77b3d8ac.js";import{s as J,o as P}from"./mat4-7dde83b1.js";const Ve=(r,o)=>{const u=J(r,o,0,0,0,0,o,0,0,0,0,o,0,0,0,0,1);return P(u,u)},We=(r,o)=>{const u=J(r,o,0,0,.5-.5*o,0,o,0,.5-.5*o,0,0,o,.5-.5*o,0,0,0,1);return P(u,u)},Ze=(r,o)=>{const u=1-o,l=J(r,.2126+.7874*u,.7152-.7152*u,.0722-.0722*u,0,.2126-.2126*u,.7152+.2848*u,.0722-.0722*u,0,.2126-.2126*u,.7152-.7152*u,.0722+.9278*u,0,0,0,0,1);return P(l,l)},tr=(r,o)=>{const u=Math.sin(o*Math.PI/180),l=Math.cos(o*Math.PI/180),c=J(r,.213+.787*l-.213*u,.715-.715*l-.715*u,.072-.072*l+.928*u,0,.213-.213*l+.143*u,.715+.285*l+.14*u,.072-.072*l-.283*u,0,.213-.213*l-.787*u,.715-.715*l+.715*u,.072+.928*l+.072*u,0,0,0,0,1);return P(c,c)},er=(r,o)=>{const u=1-2*o,l=J(r,u,0,0,o,0,u,0,o,0,0,u,o,0,0,0,1);return P(l,l)},rr=(r,o)=>{const u=J(r,.213+.787*o,.715-.715*o,.072-.072*o,0,.213-.213*o,.715+.285*o,.072-.072*o,0,.213-.213*o,.715-.715*o,.072+.928*o,0,0,0,0,1);return P(u,u)},nr=(r,o)=>{const u=1-o,l=J(r,.393+.607*u,.769-.769*u,.189-.189*u,0,.349-.349*u,.686+.314*u,.168-.168*u,0,.272-.272*u,.534-.534*u,.131+.869*u,0,0,0,0,1);return P(l,l)};class K{constructor(o,u,l){this.strength=o,this.radius=u,this.threshold=l,this.type="bloom"}interpolate(o,u,l){this.strength=C(o.strength,u.strength,l),this.radius=C(o.radius,u.radius,l),this.threshold=C(o.threshold,u.threshold,l)}clone(){return new K(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:T(this.radius),strength:this.strength,threshold:this.threshold}}}class L{constructor(o){this.radius=o,this.type="blur"}interpolate(o,u,l){this.radius=Math.round(C(o.radius,u.radius,l))}clone(){return new L(this.radius)}toJSON(){return{type:"blur",radius:T(this.radius)}}}class U{constructor(o,u){this.type=o,this.amount=u,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(o,u,l){this.amount=C(o.amount,u.amount,l),this._updateMatrix()}clone(){return new U(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const o=this._colorMatrix||St();switch(this.type){case"brightness":this._colorMatrix=Ve(o,this.amount);break;case"contrast":this._colorMatrix=We(o,this.amount);break;case"grayscale":this._colorMatrix=Ze(o,this.amount);break;case"invert":this._colorMatrix=er(o,this.amount);break;case"saturate":this._colorMatrix=rr(o,this.amount);break;case"sepia":this._colorMatrix=nr(o,this.amount)}}}let et=class{constructor(o,u,l,c){this.offsetX=o,this.offsetY=u,this.blurRadius=l,this.color=c,this.type="drop-shadow"}interpolate(o,u,l){this.offsetX=C(o.offsetX,u.offsetX,l),this.offsetY=C(o.offsetY,u.offsetY,l),this.blurRadius=C(o.blurRadius,u.blurRadius,l),this.color[0]=Math.round(C(o.color[0],u.color[0],l)),this.color[1]=Math.round(C(o.color[1],u.color[1],l)),this.color[2]=Math.round(C(o.color[2],u.color[2],l)),this.color[3]=C(o.color[3],u.color[3],l)}clone(){return new et(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const o=[...this.color];return o[3]*=255,{type:"drop-shadow",xoffset:T(this.offsetX),yoffset:T(this.offsetY),blurRadius:T(this.blurRadius),color:o}}},rt=class{constructor(o){this.angle=o,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(o,u,l){this.angle=C(o.angle,u.angle,l),this._updateMatrix()}clone(){return new rt(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const o=this._colorMatrix||St();this._colorMatrix=tr(o,this.angle)}};class Q{constructor(o){this.amount=o,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(o,u,l){this.amount=C(o.amount,u.amount,l)}clone(){return new Q(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function C(r,o,u){return r+(o-r)*u}function T(r){return Math.round(1e3*Qe(r))/1e3}function or(r){switch(r.type){case"grayscale":case"sepia":case"invert":return new U(r.type,0);case"saturate":case"brightness":case"contrast":return new U(r.type,1);case"opacity":return new Q(1);case"hue-rotate":return new rt(0);case"blur":return new L(0);case"drop-shadow":return new et(0,0,0,[...De("transparent")]);case"bloom":return new K(0,0,1)}}function ar(r,o){const u=r.length>o.length?r:o;return(r.length>o.length?o:r).every((l,c)=>l.type===u[c].type)}function ur(r,o){const u=r.length>o.length?r:o,l=r.length>o.length?o:r;for(let c=l.length;c<u.length;c++)l.push(or(u[c]))}function Sr(r){const o=r[0];return!!o&&"type"in o}var Et,Ot,kt={exports:{}};function kr(r){if(!r||r.length===0)return null;if(typeof r=="string"){const u=Rt(r);return u&&u.length!==0?u:null}const o=r.map(u=>{if(!Number.isFinite(u.scale)||u.scale<=0)throw new $("effect:invalid-scale","scale must be finite and greater than 0",{stop:u});return{scale:u.scale,effects:Rt(u.value)}});o.sort((u,l)=>l.effects.length-u.effects.length);for(let u=0;u<o.length-1;u++){if(!ar(o[u].effects,o[u+1].effects))throw new $("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:o[u].effects,b:o[u+1].effects});ur(o[u].effects,o[u+1].effects)}return o.sort((u,l)=>l.scale-u.scale),o}function Rt(r){let o;if(!r)return[];try{o=kt.exports.parse(r)}catch(u){throw new $("effect:invalid-syntax","Invalid effect syntax",{value:r,error:u})}return o.map(u=>ir(u))}function ir(r){try{switch(r.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return cr(r);case"opacity":return sr(r);case"hue-rotate":return lr(r);case"blur":return fr(r);case"drop-shadow":return hr(r);case"bloom":return pr(r)}}catch(o){throw o.details.filter=r,o}throw new $("effect:unknown-effect",`Effect '${r.name}' is not supported`,{effect:r})}function cr(r){let o=1;return Y(r.parameters,1),r.parameters.length===1&&(o=O(r.parameters[0])),new U(r.name,o)}function sr(r){let o=1;return Y(r.parameters,1),r.parameters.length===1&&(o=O(r.parameters[0])),new Q(o)}function lr(r){let o=0;return Y(r.parameters,1),r.parameters.length===1&&(o=wr(r.parameters[0])),new rt(o)}function fr(r){let o=0;return Y(r.parameters,1),r.parameters.length===1&&(o=at(r.parameters[0]),B(o,r.parameters[0])),new L(o)}function hr(r){const o=[];let u=null;for(const l of r.parameters)if(l.type==="color"){if(o.length&&Object.freeze(o),u)throw new $("effect:type-error","Accepts only one color",{});u=xr(l)}else{const c=at(l);if(Object.isFrozen(o))throw new $("effect:type-error","<length> parameters not consecutive",{lengths:o});o.push(c),o.length===3&&B(c,l)}if(o.length<2||o.length>3)throw new $("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${o.length}}`,{lengths:o});return new et(o[0],o[1],o[2]||0,u||Nt("black"))}function pr(r){let o=1,u=0,l=0;return Y(r.parameters,3),r.parameters[0]&&(o=O(r.parameters[0])),r.parameters[1]&&(u=at(r.parameters[1]),B(u,r.parameters[1])),r.parameters[2]&&(l=O(r.parameters[2])),new K(o,u,l)}function Y(r,o){if(r.length>o)throw new $("effect:type-error",`Function supports up to ${o} parameters, Actual: ${r.length}`,{parameters:r})}function V(r){if(r.type==="color")return"<color>";if(r.unit){if(ot[r.unit])return"<length>";if(nt[r.unit])return"<angle>";if(r.unit==="%")return"<percentage>"}return"<double>"}function B(r,o){if(r<0)throw new $("effect:type-error",`Negative values are not allowed, Actual: ${r}`,{term:o})}function mr(r){if(r.type!=="quantity"||r.unit!==null)throw new $("effect:type-error",`Expected <double>, Actual: ${V(r)}`,{term:r})}function gr(r){if(r.type!=="quantity"||r.unit!==null&&r.unit!=="%")throw new $("effect:type-error",`Expected <double> or <percentage>, Actual: ${V(r)}`,{term:r})}Ot=function(){function r(c,d){function y(){this.constructor=c}y.prototype=d.prototype,c.prototype=new y}function o(c,d,y,e){var v=Error.call(this,c);return Object.setPrototypeOf&&Object.setPrototypeOf(v,o.prototype),v.expected=d,v.found=y,v.location=e,v.name="SyntaxError",v}function u(c,d,y){return y=y||" ",c.length>d?c:(d-=c.length,c+(y+=y.repeat(d)).slice(0,d))}function l(c,d){var y,e={},v=(d=d!==void 0?d:{}).grammarSource,S={start:Ft},q=Ft,I="none",X=")",p=",",w="(",E="%",x="px",ut="cm",it="mm",ct="in",st="pt",lt="pc",ft="deg",ht="rad",pt="grad",mt="turn",jt="#",qt=".",It="e",gt=/^[ \t\n\r]/,dt=/^[a-z\-]/,yt=/^[0-9a-fA-F]/,vt=/^[+\-]/,N=/^[0-9]/,Jt=k("none"),Pt=b("none",!1),Xt=b(")",!1),wt=b(",",!1),Yt=k("whitespace"),xt=z([" ","	",`
`,"\r"],!1,!1),zt=k("function"),Tt=b("(",!1),Ut=k("identifier"),bt=z([["a","z"],"-"],!1,!1),Bt=k("percentage"),Dt=b("%",!1),Ht=k("length"),Gt=b("px",!1),Kt=b("cm",!1),Lt=b("mm",!1),Qt=b("in",!1),Vt=b("pt",!1),Wt=b("pc",!1),Zt=k("angle"),te=b("deg",!1),ee=b("rad",!1),re=b("grad",!1),ne=b("turn",!1),oe=k("number"),ae=k("color"),ue=b("#",!1),At=z([["0","9"],["a","f"],["A","F"]],!1,!1),Mt=z(["+","-"],!1,!1),j=z([["0","9"]],!1,!1),ie=b(".",!1),ce=b("e",!1),se=function(){return[]},le=function(t,a){return{type:"function",name:t,parameters:a||[]}},fe=function(t,a){return a.length>0?Be(t,a,3):[t]},he=function(t){return{type:"quantity",value:t.value,unit:t.unit}},pe=function(t){return{type:"color",colorType:t.type,value:t.value}},me=function(t){return t},ge=function(){return H()},de=function(t){return{value:t,unit:"%"}},ye=function(t){return{value:t,unit:"px"}},ve=function(t){return{value:t,unit:"cm"}},we=function(t){return{value:t,unit:"mm"}},xe=function(t){return{value:t,unit:"in"}},be=function(t){return{value:t,unit:"pt"}},Ae=function(t){return{value:t,unit:"pc"}},Me=function(t){return{value:t,unit:"deg"}},$e=function(t){return{value:t,unit:"rad"}},Ce=function(t){return{value:t,unit:"grad"}},Fe=function(t){return{value:t,unit:"turn"}},_e=function(t){return{value:t,unit:null}},Ee=function(){return{type:"hex",value:H()}},Oe=function(t){return{type:"function",value:t}},Re=function(){return{type:"named",value:H()}},Se=function(){return parseFloat(H())},n=0,m=0,D=[{line:1,column:1}],R=0,W=[],s=0;if("startRule"in d){if(!(d.startRule in S))throw new Error(`Can't start parsing from rule "`+d.startRule+'".');q=S[d.startRule]}function H(){return c.substring(m,n)}function b(t,a){return{type:"literal",text:t,ignoreCase:a}}function z(t,a,i){return{type:"class",parts:t,inverted:a,ignoreCase:i}}function ke(){return{type:"end"}}function k(t){return{type:"other",description:t}}function $t(t){var a,i=D[t];if(i)return i;for(a=t-1;!D[a];)a--;for(i={line:(i=D[a]).line,column:i.column};a<t;)c.charCodeAt(a)===10?(i.line++,i.column=1):i.column++,a++;return D[t]=i,i}function Ct(t,a){var i=$t(t),h=$t(a);return{source:v,start:{offset:t,line:i.line,column:i.column},end:{offset:a,line:h.line,column:h.column}}}function f(t){n<R||(n>R&&(R=n,W=[]),W.push(t))}function Ne(t,a,i){return new o(o.buildMessage(t,a),t,a,i)}function Ft(){var t;return(t=je())===e&&(t=qe()),t}function je(){var t,a;return s++,t=n,A(),c.substr(n,4)===I?(a=I,n+=4):(a=e,s===0&&f(Pt)),a!==e?(A(),m=t,t=se()):(n=t,t=e),s--,t===e&&s===0&&f(Jt),t}function qe(){var t,a;if(t=[],(a=Z())!==e)for(;a!==e;)t.push(a),a=Z();else t=e;return t}function Z(){var t,a,i,h;return t=n,A(),(a=Je())!==e?(A(),(i=Ie())===e&&(i=null),A(),c.charCodeAt(n)===41?(h=X,n++):(h=e,s===0&&f(Xt)),h!==e?(A(),m=t,t=le(a,i)):(n=t,t=e)):(n=t,t=e),t}function Ie(){var t,a,i,h,M,g,_,G;if(t=n,(a=tt())!==e){for(i=[],h=n,M=A(),c.charCodeAt(n)===44?(g=p,n++):(g=e,s===0&&f(wt)),g===e&&(g=null),_=A(),(G=tt())!==e?h=M=[M,g,_,G]:(n=h,h=e);h!==e;)i.push(h),h=n,M=A(),c.charCodeAt(n)===44?(g=p,n++):(g=e,s===0&&f(wt)),g===e&&(g=null),_=A(),(G=tt())!==e?h=M=[M,g,_,G]:(n=h,h=e);m=t,t=fe(a,i)}else n=t,t=e;return t}function tt(){var t,a;return t=n,(a=Pe())===e&&(a=Xe())===e&&(a=Ye())===e&&(a=ze()),a!==e&&(m=t,a=he(a)),(t=a)===e&&(t=n,(a=Te())!==e&&(m=t,a=pe(a)),t=a),t}function A(){var t,a;for(s++,t=[],gt.test(c.charAt(n))?(a=c.charAt(n),n++):(a=e,s===0&&f(xt));a!==e;)t.push(a),gt.test(c.charAt(n))?(a=c.charAt(n),n++):(a=e,s===0&&f(xt));return s--,a=e,s===0&&f(Yt),t}function Je(){var t,a,i;return s++,t=n,(a=_t())!==e?(c.charCodeAt(n)===40?(i=w,n++):(i=e,s===0&&f(Tt)),i!==e?(m=t,t=me(a)):(n=t,t=e)):(n=t,t=e),s--,t===e&&(a=e,s===0&&f(zt)),t}function _t(){var t,a,i;if(s++,t=n,a=[],dt.test(c.charAt(n))?(i=c.charAt(n),n++):(i=e,s===0&&f(bt)),i!==e)for(;i!==e;)a.push(i),dt.test(c.charAt(n))?(i=c.charAt(n),n++):(i=e,s===0&&f(bt));else a=e;return a!==e&&(m=t,a=ge()),s--,(t=a)===e&&(a=e,s===0&&f(Ut)),t}function Pe(){var t,a,i;return s++,t=n,A(),(a=F())!==e?(c.charCodeAt(n)===37?(i=E,n++):(i=e,s===0&&f(Dt)),i!==e?(m=t,t=de(a)):(n=t,t=e)):(n=t,t=e),s--,t===e&&s===0&&f(Bt),t}function Xe(){var t,a,i;return s++,t=n,A(),(a=F())!==e?(c.substr(n,2)===x?(i=x,n+=2):(i=e,s===0&&f(Gt)),i!==e?(m=t,t=ye(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,A(),(a=F())!==e?(c.substr(n,2)===ut?(i=ut,n+=2):(i=e,s===0&&f(Kt)),i!==e?(m=t,t=ve(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,A(),(a=F())!==e?(c.substr(n,2)===it?(i=it,n+=2):(i=e,s===0&&f(Lt)),i!==e?(m=t,t=we(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,A(),(a=F())!==e?(c.substr(n,2)===ct?(i=ct,n+=2):(i=e,s===0&&f(Qt)),i!==e?(m=t,t=xe(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,A(),(a=F())!==e?(c.substr(n,2)===st?(i=st,n+=2):(i=e,s===0&&f(Vt)),i!==e?(m=t,t=be(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,A(),(a=F())!==e?(c.substr(n,2)===lt?(i=lt,n+=2):(i=e,s===0&&f(Wt)),i!==e?(m=t,t=Ae(a)):(n=t,t=e)):(n=t,t=e)))))),s--,t===e&&s===0&&f(Ht),t}function Ye(){var t,a,i;return s++,t=n,(a=F())!==e?(c.substr(n,3)===ft?(i=ft,n+=3):(i=e,s===0&&f(te)),i!==e?(m=t,t=Me(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(a=F())!==e?(c.substr(n,3)===ht?(i=ht,n+=3):(i=e,s===0&&f(ee)),i!==e?(m=t,t=$e(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(a=F())!==e?(c.substr(n,4)===pt?(i=pt,n+=4):(i=e,s===0&&f(re)),i!==e?(m=t,t=Ce(a)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(a=F())!==e?(c.substr(n,4)===mt?(i=mt,n+=4):(i=e,s===0&&f(ne)),i!==e?(m=t,t=Fe(a)):(n=t,t=e)):(n=t,t=e)))),s--,t===e&&(a=e,s===0&&f(Zt)),t}function ze(){var t,a;return s++,t=n,A(),(a=F())!==e?(m=t,t=_e(a)):(n=t,t=e),s--,t===e&&s===0&&f(oe),t}function Te(){var t,a,i,h;if(s++,t=n,c.charCodeAt(n)===35?(a=jt,n++):(a=e,s===0&&f(ue)),a!==e){if(i=[],yt.test(c.charAt(n))?(h=c.charAt(n),n++):(h=e,s===0&&f(At)),h!==e)for(;h!==e;)i.push(h),yt.test(c.charAt(n))?(h=c.charAt(n),n++):(h=e,s===0&&f(At));else i=e;i!==e?(m=t,t=Ee()):(n=t,t=e)}else n=t,t=e;return t===e&&(t=n,(a=Z())!==e&&(m=t,a=Oe(a)),(t=a)===e&&(t=n,(a=_t())!==e&&(m=t,a=Re()),t=a)),s--,t===e&&(a=e,s===0&&f(ae)),t}function F(){var t,a,i,h,M,g,_;for(t=n,vt.test(c.charAt(n))?(c.charAt(n),n++):s===0&&f(Mt),a=n,i=[],N.test(c.charAt(n))?(h=c.charAt(n),n++):(h=e,s===0&&f(j));h!==e;)i.push(h),N.test(c.charAt(n))?(h=c.charAt(n),n++):(h=e,s===0&&f(j));if(c.charCodeAt(n)===46?(h=qt,n++):(h=e,s===0&&f(ie)),h!==e){if(M=[],N.test(c.charAt(n))?(g=c.charAt(n),n++):(g=e,s===0&&f(j)),g!==e)for(;g!==e;)M.push(g),N.test(c.charAt(n))?(g=c.charAt(n),n++):(g=e,s===0&&f(j));else M=e;M!==e?a=i=[i,h,M]:(n=a,a=e)}else n=a,a=e;if(a===e)if(a=[],N.test(c.charAt(n))?(i=c.charAt(n),n++):(i=e,s===0&&f(j)),i!==e)for(;i!==e;)a.push(i),N.test(c.charAt(n))?(i=c.charAt(n),n++):(i=e,s===0&&f(j));else a=e;if(a!==e){if(i=n,c.charCodeAt(n)===101?(h=It,n++):(h=e,s===0&&f(ce)),h!==e){if(vt.test(c.charAt(n))?(M=c.charAt(n),n++):(M=e,s===0&&f(Mt)),M===e&&(M=null),g=[],N.test(c.charAt(n))?(_=c.charAt(n),n++):(_=e,s===0&&f(j)),_!==e)for(;_!==e;)g.push(_),N.test(c.charAt(n))?(_=c.charAt(n),n++):(_=e,s===0&&f(j));else g=e;g!==e?i=h=[h,M,g]:(n=i,i=e)}else n=i,i=e;i===e&&(i=null),m=t,t=Se()}else n=t,t=e;return t}function Ue(t,a){return t.map(function(i){return i[a]})}function Be(t,a,i){return[t].concat(Ue(a,i))}if((y=q())!==e&&n===c.length)return y;throw y!==e&&n<c.length&&f(ke()),Ne(W,R<c.length?c.charAt(R):null,R<c.length?Ct(R,R+1):Ct(R,R))}return r(o,Error),o.prototype.format=function(c){var d="Error: "+this.message;if(this.location){var y,e=null;for(y=0;y<c.length;y++)if(c[y].source===this.location.source){e=c[y].text.split(/\r\n|\n|\r/g);break}var v=this.location.start,S=this.location.source+":"+v.line+":"+v.column;if(e){var q=this.location.end,I=u("",v.line.toString().length," "),X=e[v.line-1],p=(v.line===q.line?q.column:X.length+1)-v.column||1;d+=`
 --> `+S+`
`+I+` |
`+v.line+" | "+X+`
`+I+" | "+u("",v.column-1," ")+u("",p,"^")}else d+=`
 at `+S}return d},o.buildMessage=function(c,d){var y={literal:function(p){return'"'+v(p.text)+'"'},class:function(p){var w=p.parts.map(function(E){return Array.isArray(E)?S(E[0])+"-"+S(E[1]):S(E)});return"["+(p.inverted?"^":"")+w.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(p){return p.description}};function e(p){return p.charCodeAt(0).toString(16).toUpperCase()}function v(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+e(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+e(w)})}function S(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+e(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+e(w)})}function q(p){return y[p.type](p)}function I(p){var w,E,x=p.map(q);if(x.sort(),x.length>0){for(w=1,E=1;w<x.length;w++)x[w-1]!==x[w]&&(x[E]=x[w],E++);x.length=E}switch(x.length){case 1:return x[0];case 2:return x[0]+" or "+x[1];default:return x.slice(0,-1).join(", ")+", or "+x[x.length-1]}}function X(p){return p?'"'+v(p)+'"':"end of input"}return"Expected "+I(c)+" but "+X(d)+" found."},{SyntaxError:o,parse:l}},(Et=kt).exports&&(Et.exports=Ot());const nt={deg:1,grad:.9,rad:180/Math.PI,turn:360};function dr(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&nt[r.unit]!=null))throw new $("effect:type-error",`Expected <angle>, Actual: ${V(r)}`,{term:r})}const ot={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function yr(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&ot[r.unit]!=null))throw new $("effect:type-error",`Expected <length>, Actual: ${V(r)}`,{term:r})}function O(r){gr(r);const o=r.value;return B(o,r),r.unit==="%"?.01*o:o}function vr(r){return mr(r),B(r.value,r),r.value}function wr(r){return dr(r),r.value*nt[r.unit]||0}function at(r){return yr(r),r.value*ot[r.unit]||0}function xr(r){switch(r.colorType){case"hex":return He(r.value);case"named":return Nt(r.value);case"function":return Mr(r.value)}}function Nt(r){if(!Ge(r))throw new $("effect:unknown-color",`color '${r}' isn't valid`,{namedColor:r});return Ke(r)}const br=/^rgba?/i,Ar=/^hsla?/i;function Mr(r){if(Y(r.parameters,4),br.test(r.name))return[O(r.parameters[0]),O(r.parameters[1]),O(r.parameters[2]),r.parameters[3]?O(r.parameters[3]):1];if(Ar.test(r.name))return Le(vr(r.parameters[0]),O(r.parameters[1]),O(r.parameters[2]),r.parameters[3]?O(r.parameters[3]):1);throw new $("effect:syntax-error",`Invalid color function '${r.name}'`,{colorFunction:r})}export{kr as d,ur as e,Sr as h,ar as n};
