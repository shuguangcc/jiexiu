import{s as Y}from"./Error-57322e92.js";import{t as l}from"./typedArrayUtil-d9bc5fbd.js";import{a as _,o as g,g as R,B as h}from"./mat3-9a8d9db7.js";import{a as x}from"./quatf64-c94bd656.js";import{e as W}from"./mat4f64-fbeb2cd1.js";import{S as M,z as b}from"./vec3-1863987c.js";import{n as S}from"./vec3f64-6cd30318.js";import{x as B,Z as O}from"./projection-acd73147.js";import{c as E}from"./unitUtils-dd6fb8ee.js";import{h as j,J as z,P as U,s as Z}from"./Extent-a1a1de42.js";import{i as y,T as c}from"./BufferView-478024d2.js";import{t as $,r as V,o as v}from"./vec33-ec7b196f.js";const A=Y.getLogger("esri.geometry.support.meshUtils.normalProjection");function er(r,o,t,f,e){return d(f)?(F(p.TO_PCPF,y.fromTypedArray(r),c.fromTypedArray(o),c.fromTypedArray(t),f,y.fromTypedArray(e)),e):(A.error("Cannot convert spatial reference to PCPF"),e)}function tr(r,o,t,f,e){return d(f)?(F(p.FROM_PCPF,y.fromTypedArray(r),c.fromTypedArray(o),c.fromTypedArray(t),f,y.fromTypedArray(e)),e):(A.error("Cannot convert to spatial reference from PCPF"),e)}function fr(r,o,t){return B(r,o,0,t,E(o),0,r.length/3),t}function nr(r,o,t){return B(r,E(t),0,o,t,0,r.length/3),o}function ar(r,o,t){if(l(r))return o;const f=c.fromTypedArray(r),e=c.fromTypedArray(o);return $(e,f,t),o}function mr(r,o,t){if(l(r))return o;R(n,t);const f=y.fromTypedArray(r),e=y.fromTypedArray(o);return V(e,f,n),h(n)||v(e,e),o}function yr(r,o,t){if(l(r))return o;R(n,t);const f=y.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),e=y.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT);if(V(e,f,n),h(n)||v(e,e),r!==o)for(let a=3;a<r.length;a+=4)o[a]=r[a];return o}function ir(r,o,t,f,e){if(!d(f))return A.error("Cannot convert spatial reference to PCPF"),e;F(p.TO_PCPF,y.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),c.fromTypedArray(o),c.fromTypedArray(t),f,y.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT));for(let a=3;a<r.length;a+=4)e[a]=r[a];return e}function cr(r,o,t,f,e){if(!d(f))return A.error("Cannot convert to spatial reference from PCPF"),e;F(p.FROM_PCPF,y.fromTypedArray(r,16),c.fromTypedArray(o),c.fromTypedArray(t),f,y.fromTypedArray(e,16));for(let a=3;a<r.length;a+=4)e[a]=r[a];return e}function F(r,o,t,f,e,a){if(!o)return;const C=t.count,u=E(e);if(L(e))for(let m=0;m<C;m++)f.getVec(m,P),o.getVec(m,i),O(u,P,T,u),_(n,T),r===p.FROM_PCPF&&g(n,n),M(i,i,n),a.setVec(m,i);else for(let m=0;m<C;m++){f.getVec(m,P),o.getVec(m,i),O(u,P,T,u),_(n,T);const N=j(t.get(m,1));let s=Math.cos(N);r===p.TO_PCPF&&(s=1/s),n[0]*=s,n[1]*=s,n[2]*=s,n[3]*=s,n[4]*=s,n[5]*=s,r===p.FROM_PCPF&&g(n,n),M(i,i,n),b(i,i),a.setVec(m,i)}return a}function d(r){return L(r)||k(r)}function L(r){return r.isWGS84||z(r)||U(r)||Z(r)}function k(r){return r.isWebMercator}var p;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(p||(p={}));const P=S(),i=S(),T=W(),n=x();export{cr as L,fr as M,nr as O,ar as R,yr as V,tr as h,er as j,ir as k,mr as v};
